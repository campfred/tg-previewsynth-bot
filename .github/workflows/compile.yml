name: Compile

on:
    push:

jobs:
    compile:
        name: Compile
        runs-on: ubuntu-latest

        steps:
            - name: Checkout repository
              uses: actions/checkout@v4

            - name: Set up Deno
              uses: denoland/setup-deno@v2
              with:
                  deno-version: v2.x

            # - name: Install dependencies
            #   run: deno task install

            - name: Cache dependencies
              run: deno task cache

            - name: Compile binaries
              run: |
                  deno task compile-windows-x86_64
                  deno task compile-macos-x86_64
                  deno task compile-macos-aarch64
                  deno task compile-linux-x86_64
                  deno task compile-linux-aarch64

            - name: Upload artifacts
              uses: actions/upload-artifact@v4
              with:
                  name: Compiled binaries
                  path: output/*
                  if-no-files-found: error
